!function($){var n="data-ab-color",t="data-ab-parent",a="data-ab-css-background",e="ab-color-found",r={selector:"[data-adaptive-background]",parent:null,exclude:["rgb(0,0,0)","rgba(255,255,255)"],normalizeTextColor:!1,normalizedTextColors:{light:"#fff",dark:"#000"},lumaClasses:{light:"ab-light",dark:"ab-dark"}};!function(n){"use strict";var t=function(){return document.createElement("canvas").getContext("2d")},a=function(n,a){var e=new Image,r=n.src||n;"data:"!==r.substring(0,5)&&(e.crossOrigin="Anonymous"),e.onload=function(){var n=t("2d");n.drawImage(e,0,0);var r=n.getImageData(0,0,e.width,e.height);a&&a(r.data)},e.src=r},e=function(n){return["rgb(",n,")"].join("")},r=function(n){return n.map(function(n){return e(n.name)})},o=5,c=10,u={};u.colors=function(n,t){t=t||{};var u=t.exclude||[],i=t.paletteSize||c;a(n,function(a){for(var c=n.width*n.height||a.length,s={},l="",d=[],m={dominant:{name:"",count:0},palette:Array.apply(null,new Array(i)).map(Boolean).map(function(){return{name:"0,0,0",count:0}})},f=0;c>f;){if(d[0]=a[f],d[1]=a[f+1],d[2]=a[f+2],l=d.join(","),s[l]=l in s?s[l]+1:1,-1===u.indexOf(e(l))){var g=s[l];g>m.dominant.count?(m.dominant.name=l,m.dominant.count=g):m.palette.some(function(n){return g>n.count?(n.name=l,n.count=g,!0):void 0})}f+=4*o}if(t.success){var p=r(m.palette);t.success({dominant:e(m.dominant.name),secondary:p[0],palette:p})}})},n.RGBaster=n.RGBaster||u}(window),$.adaptiveBackground={run:function(o){var c=$.extend({},r,o);$(c.selector).each(function(r,o){var u=$(this),i=function(){var t=s()?l():u[0];RGBaster.colors(t,{paletteSize:20,exclude:c.exclude,success:function(t){u.attr(n,t.dominant),u.trigger(e,{color:t.dominant,palette:t.palette})}})},s=function(){var n=u.attr(a);return"undefined"!=typeof n&&n!==!1},l=function(){var n=u.css("background-image"),t=/\(([^)]+)\)/,a=t.exec(n)[1].replace(/"/g,"");return a};u.on(e,function(n,a){var e;e=c.parent&&u.parents(c.parent).length?u.parents(c.parent):u.attr(t)&&u.parents(u.attr(t)).length?u.parents(u.attr(t)):s()?u:c.parent?u.parents(c.parent):u.parent(),e.css({backgroundColor:a.color});var r=function(n){var t=a.color.match(/\d+/g);return(299*t[0]+587*t[1]+114*t[2])/1e3},o=function(n){return r(n)>=128?c.normalizedTextColors.dark:c.normalizedTextColors.light},i=function(n){return r(n)<=128?c.lumaClasses.dark:c.lumaClasses.light};c.normalizeTextColor&&e.css({color:o(a.color)}),e.addClass(i(a.color)).attr("data-ab-yaq",r(a.color)),c.success&&c.success(u,a)}),i()})}}}(jQuery);